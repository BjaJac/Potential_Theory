[
  {
    "objectID": "talwani.html#problem-description",
    "href": "talwani.html#problem-description",
    "title": "11  Gravitational attraction of a prism",
    "section": "11.1 Problem description",
    "text": "11.1 Problem description\nRecall that the vertical component of the gravitational attraction caused by an elongated prismatic body of cross section \\(S\\) is\n\\[\ng_z(x,z) = \\frac{\\partial}{\\partial z}V(x,z) = -2 f \\Delta \\rho \\int\\limits_S \\frac{(z - z')\\, dx' \\,dz'}{\\sqrt{(x-x')^2 + (z-z')^2}}.\n\\]\nIf the point of observation is at the origin, we obtain\n\\[\ng_z(0,0) = \\frac{\\partial}{\\partial z}V(0,0) = 2 f \\Delta \\rho \\int\\limits_S \\frac{z\\, dx \\, dz}{\\sqrt{x^2 + z^2}}.\n\\]\nIt can be shown that this surface integral can be equivalently replaced by a line integral taken along the periphery of \\(S\\).",
    "crumbs": [
      "Two-dimensional problems",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Gravitational attraction of a prism</span>"
    ]
  },
  {
    "objectID": "talwani.html#line-integral",
    "href": "talwani.html#line-integral",
    "title": "11  Gravitational attraction of a prism",
    "section": "11.2 Line integral",
    "text": "11.2 Line integral\nThe Stokes theorem states that, for any vector field \\(\\mathbf A = (A_x, 0, A_z)^\\top\\) there holds\n\\[\n\\int\\limits_S (\\nabla \\times \\mathbf A) \\cdot d\\mathbf s = \\oint\\limits_C \\mathbf A \\cdot d\\mathbf \\ell,\n\\]\nwhere \\(d\\mathbf\\ell = \\mathbf e_x dx + \\mathbf e_z dz\\) is the oriented line element tangential to the curve \\(C\\), and \\(d\\mathbf s = dx \\,dz \\, \\mathbf e_y\\) the oriented surface element normal to the cross section \\(S\\). It follows by inspection that\n\\[\n\\partial_z A_x - \\partial_x A_z = 2 f \\Delta \\rho \\frac{z}{x^2 + z^2}\n\\]\nsuch that, after making the ansatz (Zhou (2008))\n\\[\nA_x = 0, \\qquad A_z = -2 f \\Delta\\rho \\, z \\left(\\frac{1}{z} \\, \\tan^{-1}\\frac{x}{z}\\right) = -2 f \\Delta \\rho \\, \\theta\n\\]\nThe angle \\(\\theta\\) is taken from the positive \\(x\\)-axis towards the positive \\(z\\)-axis.\nTalwani, Worzel, and Landisman (1959) have shown that the vertical component of the gravitational attraction of a two-dimensional prismatic body is, at the origin, equal to\n\\[\ng_z(0, 0) = 2 f \\Delta \\rho \\oint\\limits_C z \\, d\\theta,\n\\]\ni.e., a line integral taken along its periphery.\nThe following sketch illustrates the situation (taken from the original Talwani paper).\n\nLet \\(ABCDEF\\) be a given polygon with \\(n\\) sides and let \\(P\\) be the point at which the gravitational attraction due to this body has to be computed.\nFurther, let \\(z\\) be defined positive downwards and let \\(\\theta\\) be measured from the positive \\(x\\)-axis towards the positive \\(z\\)-axis.\nLet us evaluate the integral \\(\\oint z\\, d\\theta\\) for the above polygon.\nWe consider here the contribution from the side \\(BC\\). The remaining sides have to be added to obtain the total gravitational attraction of the complete prism.\nAt the point \\(Q\\) the line \\(BC\\) meets the \\(x\\)-axis at an angle \\(\\phi_i\\).\nLet \\(PQ = a_i\\). For any arbitrary point \\(R = R(x,z)\\) on the side \\(BC\\) there hold the two equivalent equations\n\\[\nz = x \\tan\\theta\n\\]\nand\n\\[\nz = (x - a_i) \\tan\\phi_i.\n\\]\nAfter eliminating \\(x\\) we obtain an expression for \\(z = z(\\theta)\\):\n\\[\nz = \\frac{a_i \\tan\\phi_i \\tan\\theta}{\\tan\\phi_i - \\tan\\theta}\n\\]\nThe contribution of the segment \\(BC\\) to the above line integral can now be rewritten as\n\\[\n\\int_{BC} z \\, d\\theta = \\int\\limits_B^C \\frac{a_i \\tan\\phi_i \\tan\\theta}{\\tan\\phi_i - \\tan\\theta} \\, d\\theta =: Z_i.\n\\]\nThe vertical component of the gravitational attraction is\n\\[\ng_z(0, 0) = 2 f \\Delta \\rho \\sum_{i=1}^n Z_i.\n\\]\nIt remains to solve the integral in the expression for \\(Z_i\\). To this end, we use Sympy.",
    "crumbs": [
      "Two-dimensional problems",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Gravitational attraction of a prism</span>"
    ]
  },
  {
    "objectID": "talwani.html#implementation",
    "href": "talwani.html#implementation",
    "title": "11  Gravitational attraction of a prism",
    "section": "11.3 Implementation",
    "text": "11.3 Implementation\n\na, x, z, phi, theta, Z = symbols('a x z phi theta Z', real=True)\nZ = solve(\n    [tan(theta) * x - z, (x - a) * tan(phi) - z], \n    [x, z], dict=True)\n# Z[0][z]\nsimplify(integrate(Z[0][z], theta))\n\n\\[\\begin{equation}\\frac{a \\left(- 2 \\theta - 2 \\log{\\left(- \\tan{\\left(\\phi \\right)} + \\tan{\\left(\\theta \\right)} \\right)} \\tan{\\left(\\phi \\right)} + \\log{\\left(\\frac{1}{\\cos^{2}{\\left(\\theta \\right)}} \\right)} \\tan{\\left(\\phi \\right)}\\right) \\cos^{2}{\\left(\\phi \\right)} \\tan{\\left(\\phi \\right)}}{2}\\end{equation}\\]\n\n\nNote that with \\[\n\\log\\left( \\frac{1}{\\cos^2\\theta}\\right) = - 2 \\log \\cos\\theta\n\\] and after combining the \\(\\log\\) terms we obtain the desired integral taken in the limit of integration, i.e., \\(\\theta_i\\) and \\(\\theta_{i+1}\\) \\[\nZ_{i} =a_{1} \\sin \\phi_{i} \\cos \\phi_{i} \\left[ \\theta_{i}-\\theta_{i+1} +\\tan \\phi_{i} \\log _{s} \\frac{\\cos \\theta_{i}\\left(\\tan \\theta_{i}-\\tan \\phi_{j}\\right)}{\\cos \\theta_{i+1}\\left(\\tan \\theta_{i+1}-\\tan \\phi_{i}\\right)}\\right]\n\\] which is the equation for \\(Z_i\\) given in Talwani, Worzel, and Landisman (1959), p. 50.\n\n\n\n\n\nTalwani, Manik, J. Lamar Worzel, and Mark Landisman. 1959. “Rapid Gravity Computations for Two-Dimensional Bodies with Application to the Mendocino Submarine Fracture Zone.” Journal of Geophysical Research 64 (1): 49–59. https://doi.org/10.1029/JZ064i001p00049.\n\n\nZhou, Xiaobing. 2008. “2D Vector Gravity Potential and Line Integrals for the Gravity Anomaly Caused by a 2D Mass of Depth-Dependent Density Contrast.” GEOPHYSICS 73 (6): I43–50. https://doi.org/10.1190/1.2976116.",
    "crumbs": [
      "Two-dimensional problems",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Gravitational attraction of a prism</span>"
    ]
  },
  {
    "objectID": "line_of_mass.html#a-horizontal-straight-line-of-mass",
    "href": "line_of_mass.html#a-horizontal-straight-line-of-mass",
    "title": "10  2-D mass distributions",
    "section": "10.1 A horizontal straight line of mass",
    "text": "10.1 A horizontal straight line of mass\nAs usual, we depart from a simple geometry. Later we integrate over a cross section of arbitrary shape to obtain the potential and gravitational attraction of elongated bodies.\nFor an \\(x\\)-directed straight wire of density \\(\\rho_L\\) we obtain for the gravitational attraction in the plane \\(x=0\\)\n\\[\n\\mathbf g(0, y, z) = f \\rho_L \\int\\limits_{x'=-\\infty}^\\infty \\nabla \\frac{1}{\\sqrt{{x'}^2 + (y - y')^2 + (z - z')^2}} \\mathrm{d}x'\n\\tag{10.1}\\]\nSymPy is a Python library for symbolic mathematics. It yields the following result for the \\(z\\)-component of \\(\\mathbf g\\), i.e.,\n\\[\ng_z(0, y, z) = \\mathbf g \\cdot \\mathbf e_z =  f \\rho_L \\int\\limits_{x'=-\\infty}^\\infty \\frac{\\partial}{\\partial z} \\frac{1}{\\sqrt{{x'}^2 + (y - y')^2 + (z - z')^2}} \\mathrm{d}x'\n\\]\n\n\nCode\nx, y, z, xprime, yprime, zprime, f, rho_L = symbols('x y z xprime yprime zprime f rho_L', real=True)\ng_z = integrate(f * rho_L * diff(1 / sqrt(xprime**2 + (y - yprime)**2 + (z - zprime)**2), z), (xprime, -oo, oo))\n# display(simplify(g_z))\ndisplay(Math(f' g_z(y,z) = {latex(simplify(g_z))}'))\n\n\n\\(\\displaystyle g_z(y,z) = - \\frac{2 f \\rho_{L} \\left(z - {z}'\\right)}{\\left(y - {y}'\\right)^{2} + \\left(z - {z}'\\right)^{2}}\\)\n\n\nWe recognize that\n\\[\ng_z(y,z) = - 2 f \\rho_L \\frac{z - z'}{(y - y')^2 + (z - z')^2}\n\\]\nThe attraction of the infinite line of mass is inversely proportional to the distance from the line to the point of observation.\nThe interesting point is here that the numerator is the derivative of the denominator, i.e.,\n\\[\nf'(z) = 2(z - z')\n\\]\nand\n\\[\nf(z) = (y - y')^2 + (z - z')^2\n\\]\nWith the logarithmic derivative\n\\[\n\\int \\frac{f'(z)}{f(z)} \\mathrm dz = \\ln f(z) + C\n\\]\nwe obtain the logarithmic potential by integrating with respect to \\(z\\), which yields\n\\[\nV(y,z) = -2 f \\rho_L \\ln \\sqrt{(y - y')^2 + (z - z')^2} + C\n\\]\nor\n\n\n\\[ \\ln r^2 = 2 \\ln r \\] \\[ \\ln r = -\\ln \\frac{1}{r} \\]\n\\[\nV(y,z) = 2 f \\rho_L \\ln \\frac{1}{r}\n\\]\nNote that we set \\(C = 0 = 2 f \\rho_L \\ln 1\\).\nThus, with a proper choice of \\(C\\), we can shift the potential such that \\(V\\) takes a desired value at a given distance from the line of mass. In our case, the potential is zero at the finite distance of \\(r=1\\), and not at infinity as it would be the case for finite bodies where \\(V \\sim 1/r\\). In the 2-D case, the masses extend to infinity.\n\n\nCode\nV = 2 * f * rho_L * log(1 / sqrt((y - yprime)**2 + (z - zprime)**2))\n# display(V)\nplot(V.subs([(f, 1), (rho_L, 1), (z, 0), (zprime, 0.5), (yprime, 0)]),\n  (y, -5, 5), size=(4, 3),\n  xlabel='y', ylabel=r'$V(y)$', ylim=(-4, 2), xlim=(-5, 5), axis_center=(-5, -4))\n\n\n\n\n\nPotential \\(V\\) of an infinite wire at \\(y=0\\) and \\(z=0.5\\), \\(f \\rho_L = 1\\).\n\n\n\n\n\n\nCode\nplot(g_z.subs([(f, 1), (rho_L, 1), (z, 0), (zprime, 0.5), (yprime, 0)]), \n  (y, -5, 5), size=(4, 3),\n  xlabel='y', ylabel=r'$g_z(y)$', axis_center=(-5, 0), ylim=(0,5), xlim=(-5,5))\n\n\n\n\n\nVertical attraction \\(g_z\\) of an infinite wire at \\(y=0\\) and \\(z=0.5\\), \\(f \\rho_L = 1\\).",
    "crumbs": [
      "Two-dimensional problems",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>2-D mass distributions</span>"
    ]
  },
  {
    "objectID": "line_of_mass.html#attraction-of-a-plane-lamina",
    "href": "line_of_mass.html#attraction-of-a-plane-lamina",
    "title": "10  2-D mass distributions",
    "section": "10.2 Attraction of a plane lamina",
    "text": "10.2 Attraction of a plane lamina\nThe vertical component of attraction due to an element of area \\(\\mathrm{d}S\\) on an infinite horizontal plane lamina with density \\(\\rho\\) bounded by the planes \\(z\\) and \\(z+\\mathrm{d}z\\) is \\[\n\\mathrm{d}g = f \\rho \\mathrm{d}z \\mathrm{d}\\Omega\n\\] where \\(\\mathrm{d}\\Omega\\) is the solid angle subtended at the origin by the area \\(\\mathrm{d}S\\).\n\nIt holds \\[\n\\mathrm{d}\\Omega = \\frac{\\mathrm{d}S \\sin \\alpha}{r^{2}.}\n\\]\nIf we now consider a finite area \\(S\\) of arbitrary shape, the attraction at the origin due to the enclosed mass will be \\[\ng = f \\mathrm{d}z \\int _{S} \\rho \\, \\mathrm{d}\\Omega\n\\] or, if \\(\\rho\\) is constant over \\(S\\), this simplifies to \\[\ng = f \\rho \\Omega \\mathrm{d}z.\n\\] For a given solid angle \\(\\Omega\\), the attraction of the matter enclosed between two horizontal planes at \\(z=z_{1}\\) and \\(z=z_{2}\\) will be obtained by integrating \\[\ng = f \\Omega \\int_{z_{1}}^{z_{2}} \\rho \\, \\mathrm{d}z\n\\] and if \\(\\rho=\\mathrm{const.}\\) this becomes \\[\ng = f \\rho \\Omega (z_{2} - z_{1})\n\\] For the infinite horizontal plane the solid angle is \\(2 \\pi\\), such that the attraction of an infinite plate will be \\[\ng = 2 \\pi f \\rho (z_{2} - z_{1})\n\\] which is the vertical attraction of the Bouguer plate of thickness \\(z_{2} - z_{1}\\) and density \\(\\rho\\).",
    "crumbs": [
      "Two-dimensional problems",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>2-D mass distributions</span>"
    ]
  },
  {
    "objectID": "line_of_mass.html#the-mathrmdthetamathrmdz-solenoid",
    "href": "line_of_mass.html#the-mathrmdthetamathrmdz-solenoid",
    "title": "10  2-D mass distributions",
    "section": "10.3 The \\(\\mathrm{d}\\Theta\\mathrm{d}z\\) solenoid",
    "text": "10.3 The \\(\\mathrm{d}\\Theta\\mathrm{d}z\\) solenoid\nFirst, we consider the attraction at the origin which will result from a narrow linear strip of infinite length parallel to the \\(x\\)-axis. Such a strip will be defined by the area on the plane \\(z=\\mathrm{const.}\\) lying between two inclined planes which intersect on the \\(x\\)-axis and make with the \\(y\\)-axis the angles of \\(\\Theta\\) and \\(\\Theta + \\mathrm{d}\\Theta\\).\n\nThe attraction of this strip is proportional to the solid angle subtended by it at the origin. The solid angle \\(\\mathrm{d}\\Omega\\) between two planes intersecting at an angle \\(\\mathrm{d}\\Theta\\) will bear the same ratio to the total solid angle which the plane angle \\(\\mathrm{d}\\Theta\\) bears to the total plane angle. The total solid angle is the ratio of the surface area of a sphere to the square of its radius, or \\(4 \\pi\\), and the total plane angle is \\(2 \\pi\\). Thus \\[\n\\frac{\\mathrm{d}\\Omega}{4 \\pi} = \\frac{\\mathrm{d}\\Theta}{2 \\pi}\n\\] or \\[\n\\mathrm{d}\\Omega = 2 \\mathrm{d}\\Theta.\n\\] Introducing this to the result obtained above gives \\[\n\\mathrm{d}g = 2 f \\rho \\mathrm{d}\\Theta \\mathrm{d}z\n\\] which is the fundamental differential equation of the attraction of a two-dimensional mass. The intersection of the two planes \\(\\Theta\\) and \\(\\Theta + \\mathrm{d}\\Theta\\) with the planes \\(z\\) and \\(z+\\mathrm{d}z\\) defines an elementary prism or solenoid of infinite length and cross-section \\(\\mathrm{d}\\Theta\\mathrm{d}z\\). For a finite area in the plane of integration \\[\ng = 2 f \\iint \\rho \\mathrm{d}\\Theta \\mathrm{d}z\n\\] Around an elementary prism \\(\\mathrm{d}\\Theta\\mathrm{d}z\\) bounded by the lines \\(\\Theta\\) and \\(\\Theta + \\mathrm{d}\\Theta\\), and \\(z\\) and \\(z+\\mathrm{d}z\\), consider the line integral \\(\\oint \\Theta \\mathrm{d}z\\). Starting at the point \\((\\Theta, z)\\) and traversing the circuit in counter-clockwise direction, the resulting integral will be \\[\n\\oint \\Theta \\mathrm{d}z = 0 + (\\Theta + \\mathrm{d}\\Theta)\\mathrm{d}z + 0 - \\Theta \\mathrm{d}z = \\mathrm{d}\\Theta \\mathrm{d}z.\n\\] Over a finite area \\(S\\) we may obtain \\(\\iint \\mathrm{d}\\Theta \\mathrm{d}z\\) by \\[\n\\iint_{S} \\mathrm{d}\\Theta \\mathrm{d}z = \\iint_{S} \\left[\\oint \\Theta \\mathrm{d}z \\right].\n\\] When a separate line integral is taken around each of the elementary prisms of the area, each interior part is traversed twice, whereas the exterior parts are traversed but once and always in the same sense. Consequently, \\[\n\\iint_{S} \\mathrm{d}\\Theta \\mathrm{d}z = \\oint_{s} \\Theta \\mathrm{d}z.\n\\] The attraction of a finite mass of constant density is obtained by \\[\ng = 2 f \\rho \\oint_{s} \\Theta \\mathrm{d}z.\n\\]\nAs an alternative, one could also consider the integral \\(\\oint z \\mathrm d \\theta\\). Traversing the integral in the sense \\(\\theta, z + \\mathrm d z, \\theta + \\mathrm d \\theta, z\\) we obtain\n\\[\n\\oint z \\mathrm{d}\\Theta  = 0 + (z + \\mathrm{d}z)\\mathrm{d}\\Theta + 0 - z \\mathrm{d}\\Theta = \\mathrm{d}\\Theta \\mathrm{d}z.\n\\] and \\[\ng = 2 f \\rho \\oint_{s} z \\mathrm{d}\\Theta.\n\\]\n\n\n\n\n\nHubbert, M. King. 1948. “A LINE-INTEGRAL METHOD OF COMPUTING THE GRAVIMETRIC EFFECTS OF TWO-DIMENSIONAL MASSES.” GEOPHYSICS 13 (2): 215–25. https://doi.org/10.1190/1.1437395.\n\n\nTalwani, Manik, J. Lamar Worzel, and Mark Landisman. 1959. “Rapid Gravity Computations for Two-Dimensional Bodies with Application to the Mendocino Submarine Fracture Zone.” Journal of Geophysical Research 64 (1): 49–59. https://doi.org/10.1029/JZ064i001p00049.",
    "crumbs": [
      "Two-dimensional problems",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>2-D mass distributions</span>"
    ]
  },
  {
    "objectID": "Talwani-Implementation.html#sort-the-vertices",
    "href": "Talwani-Implementation.html#sort-the-vertices",
    "title": "12  Implementation of the TALWANI approach",
    "section": "12.1 Sort the vertices",
    "text": "12.1 Sort the vertices\nFirst, we have to sort the vertices in the case that they are given in an arbitrary order.\nTo this end, we compute the polar angles taken from the center of the polygon to each of the vertices and sort in descending order.\n\n\nCode\npoly = Polygon(x, z, 500)\n\n\n\n\nCode\nfig, ax = plt.subplots()\nplt.plot(poly.x, poly.z, marker='.')\nax.set_aspect('equal', 'box');\n\n\n\n\n\n\n\n\n\n\n\nCode\ncylinder(np.array([-10., 0.]), poly.density * np.pi * radius**2, np.array([0., 10.]))\n\n\narray([1.04834947e-08, 1.04834947e-08])\n\n\n\n\nCode\ntalwani([-50, 0], poly)\n\n\n8.043842124376165e-10\n\n\n\n\nCode\nprofile = np.linspace(start=-40, stop=40, num=81)\nnpts = profile.size\ngtal = np.zeros(npts)\ngcyl = np.zeros(npts)\nmass = poly.density * np.pi * radius**2\nfor k in range(npts):\n    gtal[k] = talwani(np.array([profile[k], 0]), poly)\n    gcyl[k] = cylinder(np.array([profile[k], 0]), mass, np.array([xc, zc]))[1]\n\n\n\n\nCode\nfig, (ax1, ax2) = plt.subplots(1, 2)\nax1.plot(profile, gtal, marker='.')\nax1.plot(profile, gcyl, marker='.');\nax2.plot(profile, gcyl - gtal, marker='.');\n\n\n\n\n\n\n\n\n\n\n\nCode\nnorm(gtal - gcyl) / norm(gcyl)\n\n\n0.002516090288496242",
    "crumbs": [
      "Two-dimensional problems",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Implementation of the TALWANI approach for the gravity computation of 2-D bodies</span>"
    ]
  }
]